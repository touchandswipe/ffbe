<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="description" content="Final Fantasy Brave Exvius - Units Guide (Beta) - A community effort" />
    <meta name="author" content="Sam GreenPuck" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Final Fantasy Brave Exvius - Units Guide (Beta) - A community effort</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap-theme.min.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<!-- Custom styles for this template -->
<style type="text/css">
.logoShdw {
-webkit-filter: drop-shadow(0px 0px 6px #0033FF);
filter: drop-shadow(0px 0px 5px #0033FF);
margin-top:-8px;
margin-left:-4px;
}
    .equip {
    	width:35px;
    	height:35px;
    }
    .equipNo {
	-webkit-filter: grayscale(100%);
	filter: grayscale(100%);
	opacity: 0.2;
    	filter: alpha(opacity=20); /* For IE8 and earlier */
    }
    .evoCurrent {
	-webkit-filter: drop-shadow(0px 0px 5px #AA00AA);
	filter: drop-shadow(0px 0px 5px #AA00AA);
    }
    .va {vertical-align:middle;}
    .text-fav {color:#FFFFFF;}
    .kdb-r {
    background:#FFCC00;
    color:#000000;
    padding:0 3px 0 3px;
    }
    .kdb-d {
    background:#CC0000;
    color:#FFFFFF;
    font-size:10px;
    padding:2px 3px 2px 3px;
    }
    .release {
    border: 1px solid #CCCCCC;
    display: inline-block;
    border-radius: 5px;
    padding:2px 5px;
    }
    .shareLink {background:#FFDB4D;}
    .sp2 {margin:2px;}
    .clear {clear:both;}
</style>
<!-- START JSON Code-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="//touchandswipe.github.io/bravefrontier/js/lz-string.min.js"></script>
<script src="//touchandswipe.github.io/monsterstrike/js/msguidecommon.js"></script>

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48617906-1', 'auto');
  ga('send', 'pageview');
</script>
</head>

<!-- MAIN BODY CONTENT -->
<body>
    <!-- Static navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container-fluid">
	<div class="navbar-header">
	  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	    <span class="sr-only">Toggle navigation</span>
	    <span class="icon-bar"></span>
	    <span class="icon-bar"></span>
	    <span class="icon-bar"></span>
	  </button>
	  <a class="navbar-brand" href="http://bravefrontierpros.tumblr.com"><img src="http://ffbe.summonerscentral.com/img/ffbeicon.png" class="img-circle logoShdw" width="64" alt="Monster Strike PROs"/></a>
	</div>
</div>
</div>

<!-- Mainbody -->
<div class="container-fluid">
<div style="height:60px;"></div>

<!-- Google Manual labnol.org responsive ads-->
<div class="text-center" style="margin-bottom:5px;">
<div id="google-ads-1"></div>
<script type="text/javascript"> 
 
    /* Calculate the width of available ad space */
    ad = document.getElementById('google-ads-1');
 
    if (ad.getBoundingClientRect().width) {
	adWidth = ad.getBoundingClientRect().width; // for modern browsers 
    } else {
	adWidth = ad.offsetWidth; // for old IE 
    }
 
    /* Replace ca-pub-XXX with your AdSense Publisher ID */ 
    google_ad_client = "ca-pub-2145833818900192";
 
    /* Replace 1234567890 with the AdSense Ad Slot ID */ 
    google_ad_slot = "1402210464";
  
    /* Do not change anything after this line */
    if ( adWidth >= 728 )
      google_ad_size = ["728", "90"];  /* Leaderboard 728x90 */
    else if ( adWidth >= 468 )
      google_ad_size = ["468", "60"];  /* Banner (468 x 60) */
    else if ( adWidth >= 336 )
      google_ad_size = ["336", "280"]; /* Large Rectangle (336 x 280) */
    else if ( adWidth >= 300 )
      google_ad_size = ["300", "250"]; /* Medium Rectangle (300 x 250) */
    else if ( adWidth >= 250 )
      google_ad_size = ["250", "250"]; /* Square (250 x 250) */
    else if ( adWidth >= 200 )
      google_ad_size = ["200", "200"]; /* Small Square (200 x 200) */
    else if ( adWidth >= 180 )
      google_ad_size = ["180", "150"]; /* Small Rectangle (180 x 150) */
    else
      google_ad_size = ["125", "125"]; /* Button (125 x 125) */
 
    document.write (
     '<ins class="adsbygoogle" style="display:inline-block;width:' 
      + google_ad_size[0] + 'px;height:' 
      + google_ad_size[1] + 'px" data-ad-client="' 
      + google_ad_client + '" data-ad-slot="' 
      + google_ad_slot + '"></ins>'
    );
  
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
</div>
<!--mainbody -->
<div class="row">
	<div class="col-md-12" id="unitContent"></div>
</div>

<!-- ACTIVATION SCRIPTS -->
<script type="text/javascript">
/*initialise build*/
function initialize(data) {
	var uName="Rain";
	var foundArray=[];
	var imgprefix="http://ffbe.summonerscentral.com/img/";
	/*match rain*/
	for (i=1;i<data.length;i++) {
		if (data[i][1]==uName) {
			console.log("match found "+data[i][1]);
			foundArray.push(data[i]);
		}
	}
	/*Process stringed arrays*/
	var processPos=[7,8,9,10,11,13,14]
	for (var i in foundArray) {
		/*split values into array*/
		for (j in processPos) {
			foundArray[i][processPos[j]]=foundArray[i][processPos[j]].split(",")
		}
	}
	/*build stats*/
	var outHTML='<h2>Stats</h2><div class="table-responsive"><table class="table table-striped table-bordered">';
	outHTML+='<thead><tr><th>Rarity</th><th>HP</th><th>MP</th><th>ATK</th><th>DEF</th><th>INT</th><th>SPR</th></tr></thead>';
	for (var i in foundArray) {
		outHTML+='<tr><td>'+foundArray[i][2]+'<i class="fa fa-star"></i></td>';
		for (var j in foundArray[i][7]) {
			outHTML+='<td>'+foundArray[i][7][j]+' <span class="text-primary">('+foundArray[i][8][j]+')</span></td>';
		}
		outHTML+='</tr>'
	}
	outHTML+='</table></div>';
	/*build weapons*/
	outHTML+='<h2>Weapons</h2><div class="table-responsive"><table class="table table-striped table-bordered">';
	outHTML+='<tr class="text-center">';
	for (var i=0;i<=7;i++) {
		outHTML+='<td>';
		if (foundArray[foundArray.length-1][9][i]==0)
			outHTML+='<img src="'+imgprefix+'weap'+ +(i+1) + '.png" class="equip equipNo" />';
		else
			outHTML+='<img src="'+imgprefix+'weap'+ +(i+1) + '.png" class="equip" />';
		outHTML+='</td>';
	}
	outHTML+='</tr>';
	outHTML+='<tr class="text-center">';
	for (var i=8;i<=15;i++) {
		outHTML+='<td>';
		if (foundArray[foundArray.length-1][9][i]==0)
			outHTML+='<img src="'+imgprefix+'weap'+ +(i+1) + '.png" class="equip equipNo" />';
		else
			outHTML+='<img src="'+imgprefix+'weap'+ +(i+1) + '.png" class="equip" />';
		outHTML+='</td>';
	}
	outHTML+='</tr>';
	outHTML+='</table></div>';
	/*build armor*/
	outHTML+='<h2>Armors</h2><div class="table-responsive"><table class="table table-striped table-bordered">';
	outHTML+='<tr class="text-center">';
	for (var i=0;i<=7;i++) {
		outHTML+='<td>';
		if (foundArray[foundArray.length-1][10][i]==0)
			outHTML+='<img src="'+imgprefix+'armor'+ +(i+1) + '.png" class="equip equipNo" />';
		else
			outHTML+='<img src="'+imgprefix+'armor'+ +(i+1) + '.png" class="equip" />';
		outHTML+='</td>';
	}
	outHTML+='</tr>';
	outHTML+='</table></div>';
	/*output*/
	$("#unitContent").html(outHTML);
}


$(document).ready( function(e) {
    /*LocalStorage Retreival and storage*/
    if (localStorage.ffbeguideadv) {
    	/*Quick query to check for new entries*/
    	var serverUnitsCount=0;
    	var localUnitsCount=(!localStorage.ffbeguideadvCount) ? 0 : parseInt(localStorage.ffbeguideadvCount);
	var url = "https://sheets.googleapis.com/v4/spreadsheets/1oKx5_qbgx0pCspH9LFr0GV3_thT3VG6AiCXhdt1K56s/values/Units?key=AIzaSyCyF9yZ9Lyl57HAQXtzrd3yONewk4-fGSg&range=A:S";

	/*Send the JSONP request*/
	$.ajax({
		url: url,
		success: function (quickData) {
			console.log("success: "+quickData);
			serverUnitsCount=quickData.values.length;
			/*Prompt to Sync*/
			if (serverUnitsCount > localUnitsCount)
				bfpAlert("New Units Detected",'New units available for sync. You can sync now or later at any time. Do you wish to sync now? <div class="text-right"><button type="button" class="btn btn-success" id="syncNewBtn"><i class="fa fa-cloud-download"></i> Sync Now</button> <button type="button" class="btn btn-default" id="syncCancel">Cancel</button></div>');
			else {
				guideData=LZString.decompressFromUTF16(localStorage.ffbeguideadv);
				if (isValidJSON(guideData))
					initialize(JSON.parse(guideData).values);
				else {
					/*LocalStorage Delete and Refresh*/
					alert("Corrupted data detected or Data structure has changed. Proceed to Fix.");
					localStorage.removeItem("ffbeguideadv");
					localStorage.removeItem("ffbeguideadvCount");
					history.pushState(null, null, location.pathname);
					location.reload(true);
					}
				}
	  		}
	});
    } else {
	/*Init loader if no localstorage*/
	$('#progressModal').modal({
		keyboard:false,
		backdrop:'static',
		toggle:true
	})
    	var url = "https://sheets.googleapis.com/v4/spreadsheets/1oKx5_qbgx0pCspH9LFr0GV3_thT3VG6AiCXhdt1K56s/values/Units?key=AIzaSyCyF9yZ9Lyl57HAQXtzrd3yONewk4-fGSg&range=A:S";
	/*AJAX*/
	$.ajax({
		url: url,
		success: function (fusionData) {
			console.log("success: "+fusionData);
			/*Save in local storage*/
			localStorage.setItem("ffbeguideadv",LZString.compressToUTF16(JSON.stringify(fusionData)));
			localStorage.setItem("ffbeguideadvCount",fusionData.values.length);
			initialize(fusionData.values);
	  	}
	})
} /*End localstorage checknload*/

/*RESET*/
$('#resetBtn').click( function(e) {
	/*Google analytics*/
	ga('send', 'pageview', {
  		'page': '/vurl/syncUnitGuideAdvance',
  		'title': 'FFBE Reset Data'
	});
    	/*LocalStorage Delete and Refresh*/
	localStorage.removeItem("ffbeguideadv");
	localStorage.removeItem("ffbeguideadvCount");
	history.pushState(null, null, location.pathname);
	location.reload(true);
})

/*New units detect*/
$(document).on("click", "#syncDetectBtn", function(e){    
    bfpAlert("New Units Detected",'New units available for sync. You can sync now or later at any time. Do you wish to sync now? <div class="text-right"><button type="button" class="btn btn-success" id="syncNewBtn"><i class="fa fa-cloud-download"></i>Sync Now</button> <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button></div>');
})

/*New units sync*/
$(document).on("click", "#syncNewBtn", function(e){    
	/*Force sync*/
	localStorage.removeItem("ffbeguideadv");
	localStorage.removeItem("ffbeguideadvCount");
	history.pushState(null, null, location.pathname);
	location.reload(true);
})

/*Cancel sync*/
$(document).on("click", "#syncCancel", function(e){    
	guideData=LZString.decompressFromUTF16(localStorage.ffbeguideadv);
	if (isValidJSON(guideData)) {
		$('#alertmodal').modal('hide');
		initialize(JSON.parse(guideData));
	} else {
		/*LocalStorage Delete and Refresh*/
		alert("Corrupted data detected or Data structure has changed. Proceed to Fix.");
		localStorage.removeItem("ffbeguideadv");
		localStorage.removeItem("ffbeguideadvCount");
		history.pushState(null, null, location.pathname);
		location.reload(true);
	}
})

})
</script>

<!-- Google Responsive Ad -->
<div class="text-center clear" style="width:100%;margin:0 auto;">
<!-- Google Manual labnol.org responsive ads-->
<div id="google-ads-2"></div>
<script type="text/javascript"> 
 
    /* Calculate the width of available ad space */
    ad = document.getElementById('google-ads-2');
 
    if (ad.getBoundingClientRect().width) {
	adWidth = ad.getBoundingClientRect().width; // for modern browsers 
    } else {
	adWidth = ad.offsetWidth; // for old IE 
    }
 
    /* Replace ca-pub-XXX with your AdSense Publisher ID */ 
    google_ad_client = "ca-pub-2145833818900192";
 
    /* Replace 1234567890 with the AdSense Ad Slot ID */ 
    google_ad_slot = "1402210464";
  
    /* Do not change anything after this line */
    if ( adWidth >= 728 )
      google_ad_size = ["728", "90"];  /* Leaderboard 728x90 */
    else if ( adWidth >= 468 )
      google_ad_size = ["468", "60"];  /* Banner (468 x 60) */
    else if ( adWidth >= 336 )
      google_ad_size = ["336", "280"]; /* Large Rectangle (336 x 280) */
    else if ( adWidth >= 300 )
      google_ad_size = ["300", "250"]; /* Medium Rectangle (300 x 250) */
    else if ( adWidth >= 250 )
      google_ad_size = ["250", "250"]; /* Square (250 x 250) */
    else if ( adWidth >= 200 )
      google_ad_size = ["200", "200"]; /* Small Square (200 x 200) */
    else if ( adWidth >= 180 )
      google_ad_size = ["180", "150"]; /* Small Rectangle (180 x 150) */
    else
      google_ad_size = ["125", "125"]; /* Button (125 x 125) */
 
    document.write (
     '<ins class="adsbygoogle" style="display:inline-block;width:' 
      + google_ad_size[0] + 'px;height:' 
      + google_ad_size[1] + 'px" data-ad-client="' 
      + google_ad_client + '" data-ad-slot="' 
      + google_ad_slot + '"></ins>'
    );
  
    (adsbygoogle = window.adsbygoogle || []).push({});
 
</script>
</div>

<!-- disqus discussion -->
<div class="row"><div class="col-xs-12">
<div id="disqus_thread"></div>
    <script type="text/javascript">
	var disqus_shortname = 'finalfantasybraveexvius';
	(function() {
	    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div></div>

</div> <!-- /container -->

<!-- Modal for Progress-->
<div class="modal fade" id="progressModal" tabindex="-1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
	<div class="text-center">
	    <h3 class="text-primary"><b>Summoning units</b></h3>
	    <i class="fa fa-spinner fa-spin fa-5x"></i>
	    <h4 class="text-primary">A moment please ...</h4>
	    <h5>(Note: Images will continue to load progressively after.)</h5>
	</div>
      </div>
    </div>
  </div>
</div>

<!-- Alert Modal -->
<div class="modal fade" id="alertmodal" tabindex="-1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
    <div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h3 class="modal-title text-danger"><i class="fa fa-fire"></i> Lugina Grumbles Grumbles</h3></div>
      <div class="modal-body">
	<div id="alertSpace" class="alert"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
